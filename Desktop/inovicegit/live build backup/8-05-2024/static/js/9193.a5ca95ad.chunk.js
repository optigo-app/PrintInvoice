"use strict";(self.webpackChunkinvoice=self.webpackChunkinvoice||[]).push([[9193],{92646:(e,t,o)=>{o.r(t),o.d(t,{default:()=>r});var d=o(72791),l=o(80444),n=o(1683),i=o(90408),s=o(81431),a=o(80184);const r=e=>{let{urls:t,token:o,invoiceNo:r,printName:c,evn:x,ApiVer:h}=e;const[p,u]=(0,d.useState)(!0),[b,m]=(0,d.useState)(""),[v,w]=(0,d.useState)({}),[g,f]=(0,d.useState)([]),[y,k]=(0,d.useState)(!0);return(0,d.useEffect)((()=>{(async()=>{try{const e=await(0,n.k_)(o,r,c,t,x,h);if("200"===(null===e||void 0===e?void 0:e.Status)){(0,n.nK)(null===e||void 0===e?void 0:e.Data)?(u(!1),m("Data Not Found")):((e=>{let t=null===e||void 0===e?void 0:e.BillPrint_Json[0],o=[];null===e||void 0===e||e.BillPrint_Json1.forEach(((t,d)=>{const l=null===e||void 0===e?void 0:e.BillPrint_Json2.reduce(((e,o)=>((null===t||void 0===t?void 0:t.SrJobno)===(null===o||void 0===o?void 0:o.StockBarcode)&&(1===o.MasterManagement_DiamondStoneTypeid&&(e.diaPcs+=o.Pcs,e.diaWt+=o.Wt),2===o.MasterManagement_DiamondStoneTypeid&&(e.csPcs+=o.Pcs,e.csWt+=o.Wt)),e)),{diaPcs:0,diaWt:0,csPcs:0,csWt:0});let i="",s="";0!==(null===l||void 0===l?void 0:l.diaWt)&&(i="With Diamond ".concat(null===t||void 0===t?void 0:t.MetalPurity," weight ").concat((0,n.dl)(null===t||void 0===t?void 0:t.NetWt,3)," grams No of Diamond ").concat((0,n.dl)(null===l||void 0===l?void 0:l.diaPcs,0)," Piece Diamond Weight ").concat((0,n.dl)(null===l||void 0===l?void 0:l.diaWt,3)," cts")),0!==(null===l||void 0===l?void 0:l.csWt)&&(s="With ColorStone ".concat(null===t||void 0===t?void 0:t.MetalPurity," weight ").concat((0,n.dl)(null===t||void 0===t?void 0:t.NetWt,3)," grams No of ColorStone ").concat((0,n.dl)(null===l||void 0===l?void 0:l.csPcs,0)," Piece ColorStone Weight ").concat((0,n.dl)(null===l||void 0===l?void 0:l.csWt,3)," cts"));let a={srNo:d,barcode:null===t||void 0===t?void 0:t.SrJobno,designNo:null===t||void 0===t?void 0:t.designno,jewellery:"Jewellery",goldJewellery:"Gold Jewellery",description:"".concat(null===t||void 0===t?void 0:t.MetalPurity," Jewellery ").concat(null===t||void 0===t?void 0:t.Categoryname," ").concat(i," ").concat(s),pcs:1,piece:"".concat(null!==t&&void 0!==t&&t.Categoryname.includes("ear")?"Pair":"Piece"),hkd:null===t||void 0===t?void 0:t.TotalAmount,grossWt:(0,n.dl)(null===t||void 0===t?void 0:t.grosswt,3),gramSymbol:"G",cn:"CN"};o.push(a)})),f(o),w(t),setTimeout((()=>{document.getElementById("test-table-xls-button").click()}),0)})(null===e||void 0===e?void 0:e.Data),u(!1))}else u(!1),m(null===e||void 0===e?void 0:e.Message)}catch(e){console.error(e)}})()}),[]),(0,a.jsx)(a.Fragment,{children:p?(0,a.jsx)(l.Z,{}):""===b?(0,a.jsxs)("div",{className:"d-none",children:[(0,a.jsx)(i.Z,{id:"test-table-xls-button",className:"download-table-xls-button btn btn-success text-black bg-success px-2 py-1 fs-5 d-none",table:"table-to-xls",filename:"Sale_Format_A_".concat(null===v||void 0===v?void 0:v.InvoiceNo,"_").concat(Date.now()),sheet:"tablexls",buttonText:"Download as XLS"}),(0,a.jsxs)("table",{id:"table-to-xls",className:"".concat(null===s.Z||void 0===s.Z?void 0:s.Z.excelToJsonDownloadATable),children:[(0,a.jsxs)("thead",{children:[(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{width:"100"}),(0,a.jsx)("th",{width:"100"}),(0,a.jsx)("th",{width:"100"}),(0,a.jsx)("th",{width:"100"}),(0,a.jsx)("th",{width:"100"}),(0,a.jsx)("th",{width:"500"}),(0,a.jsx)("th",{width:"100"}),(0,a.jsx)("th",{width:"100"}),(0,a.jsx)("th",{width:"100"}),(0,a.jsx)("th",{width:"100"}),(0,a.jsx)("th",{width:"100"}),(0,a.jsx)("th",{width:"100"}),(0,a.jsx)("th",{width:"100"})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{width:"100",style:{border:"1px solid black",padding:"1px"},children:"Sr. No."}),(0,a.jsx)("th",{width:"100",style:{border:"1px solid black",padding:"1px"},children:"Barcode"}),(0,a.jsx)("th",{width:"100",style:{border:"1px solid black",padding:"1px"},children:"Design No"}),(0,a.jsx)("th",{width:"100",style:{border:"1px solid black",padding:"1px"}}),(0,a.jsx)("th",{width:"100",style:{border:"1px solid black",padding:"1px"}}),(0,a.jsx)("th",{width:"500",style:{border:"1px solid black",padding:"1px"}}),(0,a.jsx)("th",{width:"100",style:{border:"1px solid black",padding:"1px"}}),(0,a.jsx)("th",{width:"100",style:{border:"1px solid black",padding:"1px"}}),(0,a.jsx)("th",{width:"100",style:{border:"1px solid black",padding:"1px"},children:"HKD"}),(0,a.jsx)("th",{width:"100",style:{border:"1px solid black",padding:"1px"},children:"Gross weight"}),(0,a.jsx)("th",{width:"100",style:{border:"1px solid black",padding:"1px"}}),(0,a.jsx)("th",{width:"100",style:{border:"1px solid black",padding:"1px"}}),(0,a.jsx)("th",{width:"100",style:{border:"1px solid black",padding:"1px"},children:"Barcode"})]})]}),(0,a.jsx)("tbody",{children:g.length>0&&g.map(((e,t)=>(0,a.jsxs)("tr",{children:[(0,a.jsxs)("td",{width:"100",style:{border:"1px solid black",padding:"1px"},className:"text-danger",children:["  \xa0",(0,n.dl)(t+1,0)]}),(0,a.jsx)("td",{width:"100",style:{border:"1px solid black",padding:"1px"},className:"text-danger",children:null===e||void 0===e?void 0:e.barcode}),(0,a.jsx)("td",{width:"100",style:{border:"1px solid black",padding:"1px"},className:"text-danger",children:null===e||void 0===e?void 0:e.designNo}),(0,a.jsx)("td",{width:"100",style:{border:"1px solid black",padding:"1px"},className:"text-danger",children:null===e||void 0===e?void 0:e.jewellery}),(0,a.jsx)("td",{width:"100",style:{border:"1px solid black",padding:"1px"},className:"text-danger",children:null===e||void 0===e?void 0:e.goldJewellery}),(0,a.jsx)("td",{width:"500",style:{border:"1px solid black",padding:"1px"},className:"text-danger",children:null===e||void 0===e?void 0:e.description}),(0,a.jsxs)("td",{width:"100",style:{border:"1px solid black",padding:"1px"},className:"text-danger",children:["\xa0",(0,n.dl)(null===e||void 0===e?void 0:e.pcs,0)]}),(0,a.jsx)("td",{width:"100",style:{border:"1px solid black",padding:"1px"},className:"text-danger",children:null===e||void 0===e?void 0:e.piece}),(0,a.jsxs)("td",{width:"100",style:{border:"1px solid black",padding:"1px"},className:"text-danger",children:["\xa0",(0,n.dl)(null===e||void 0===e?void 0:e.hkd,2)]}),(0,a.jsxs)("td",{width:"100",style:{border:"1px solid black",padding:"1px"},className:"text-danger",children:["\xa0",(0,n.dl)(null===e||void 0===e?void 0:e.grossWt,3)]}),(0,a.jsx)("td",{width:"100",style:{border:"1px solid black",padding:"1px"},className:"text-danger",children:null===e||void 0===e?void 0:e.gramSymbol}),(0,a.jsx)("td",{width:"100",style:{border:"1px solid black",padding:"1px"},className:"text-danger",children:null===e||void 0===e?void 0:e.cn}),(0,a.jsx)("td",{width:"100",style:{border:"1px solid black",padding:"1px"},className:"text-danger",children:null===e||void 0===e?void 0:e.barcode})]},t)))})]})]}):(0,a.jsx)("p",{className:"text-danger fs-2 fw-bold mt-5 text-center w-50 mx-auto",children:b})})}},90408:(e,t,o)=>{var d=function(){function e(e,t){for(var o=0;o<t.length;o++){var d=t[o];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(e,d.key,d)}}return function(t,o,d){return o&&e(t.prototype,o),d&&e(t,d),t}}(),l=o(72791),n=s(l),i=s(o(52007));function s(e){return e&&e.__esModule?e:{default:e}}var a={table:i.default.string.isRequired,filename:i.default.string.isRequired,sheet:i.default.string.isRequired,id:i.default.string,className:i.default.string,buttonText:i.default.string},r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.handleDownload=o.handleDownload.bind(o),o}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),d(t,[{key:"handleDownload",value:function(){if(!document)return null;if(1!==document.getElementById(this.props.table).nodeType||"TABLE"!==document.getElementById(this.props.table).nodeName)return null;var e=document.getElementById(this.props.table).outerHTML,o=String(this.props.sheet),d=String(this.props.filename)+".xls",l={worksheet:o||"Worksheet",table:e};if(window.navigator.msSaveOrOpenBlob){var n=new Blob(['<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta charset="UTF-8">\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body>'+e+"</body></html>"]);return document.getElementById("react-html-table-to-excel").click()((function(){window.navigator.msSaveOrOpenBlob(n,d)})),!0}var i=window.document.createElement("a");return i.href="data:application/vnd.ms-excel;base64,"+t.base64(t.format('<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta charset="UTF-8">\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body>{table}</body></html>',l)),i.download=d,document.body.appendChild(i),i.click(),document.body.removeChild(i),!0}},{key:"render",value:function(){return n.default.createElement("button",{id:this.props.id,className:this.props.className,type:"button",onClick:this.handleDownload},this.props.buttonText)}}],[{key:"base64",value:function(e){return window.btoa(unescape(encodeURIComponent(e)))}},{key:"format",value:function(e,t){return e.replace(/{(\w+)}/g,(function(e,o){return t[o]}))}}]),t}(l.Component);r.propTypes=a,r.defaultProps={id:"button-download-as-xls",className:"button-download",buttonText:"Download"},t.Z=r},81431:(e,t,o)=>{o.d(t,{Z:()=>d});const d={excelToJsonDownloadATable:"exporttojsondownloadA_excelToJsonDownloadATable__Rq656",paraColor:"exporttojsondownloadA_paraColor__kWInJ",red_text:"exporttojsondownloadA_red_text__TnhgO",print_sec_sum4:"exporttojsondownloadA_print_sec_sum4__UpyYD"}}}]);
//# sourceMappingURL=9193.a5ca95ad.chunk.js.map